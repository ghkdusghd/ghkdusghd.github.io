---
title: í”„ë ˆì„ì›Œí¬ ë§Œë“¤ê¸° V5-V3
parent: Spring MVC
nav_order: -6
---

### 5ï¸âƒ£ &nbsp; V5 - V3

ğŸ¤”ğŸ’­ ì•„ì£¼ ì™„ë²½í•´ì¡Œì–´! ì´ì œ ë” ì†ë³¼ ê³³ì´ ì—†ê² ëŠ”ê±¸! ( ì •ë§ ê·¸ëŸ´ê¹Œ ... ? )

<img src="/assets/images/pages/cs/mvc/05. V5 pattern.png">
<span style="color: #808080">ì¶œì²˜: ê¹€ì˜í•œì˜ ìŠ¤í”„ë§MVC (ì¸í”„ëŸ°)</span>

ğŸ’¡ V4 ëŠ” ì•„ì£¼ ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ í”„ë ˆì„ì›Œí¬ì´ì§€ë§Œ, ì˜¤ë¡œì§€ ë‹¨ í•œ ê°€ì§€ ë°©ì‹ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ì´ë¥¼ ê°œì„ í•˜ì—¬ ìœ ì—°í•œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë„ë¡ í™•ì¥í•´ë³¼ ê²ƒì´ë‹¤.

### âš¡ï¸ &nbsp; 5-1. MyHandlerAdapter

- í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬) ë¥¼ ì§€ì •í•˜ì—¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì—ˆë‹¤. ì´ë²ˆ V5 ì—ì„œëŠ” V3 ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ìš°ì„  ê°€ì ¸ì™€ë³¼ ê²ƒì´ë¼ì„œ V3 ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” ModelView í•¸ë“¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ì¤¬ë‹¤.

```java
public interface MyHandlerAdapter {

    boolean supports(Object handler);

    ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException;

}
```

### âš¡ï¸ &nbsp; 5-2. FrontControllerServletV5

- uri ë§¤í•‘ì„ ìœ„í•œ Map ê°ì²´ì˜ ì œë„¤ë¦­ì„ Object íƒ€ì…ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì–´ë–¤ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ê°€ ì™€ë„ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ í™•ì¥í–ˆë‹¤.

- List íƒ€ì…ìœ¼ë¡œ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬) ë¦¬ìŠ¤íŠ¸ë¥¼ ë„£ì—ˆë‹¤.ì´ë•Œ ë°”ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë„£ëŠ” ê²ƒì´ ì•„ë‹Œ, ì¤‘ê°„ ë‹¨ê³„ì— í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°(ControllerV3HandlerAdapter) ë¥¼ ê±°ì¹˜ê²Œ ë§Œë“¤ì—ˆë‹¤.

- ì´ë²ˆ V5 ì˜ˆì œì—ì„œëŠ” V3 ì˜ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê²Œ ë§Œë“¤ê³  ì‹¤ì œ ë¡œì§ë„ V3 ì»¨íŠ¸ë¡¤ëŸ¬ì— ë§ì¶° êµ¬í˜„í–ˆë‹¤.

```java

@WebServlet(name = "frontControllerServletV5", urlPatterns = "/front-controller/v5/*")
public class FrontControllerServletV5 extends HttpServlet {

    //ì–´ë–¤ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì™€ë„ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ Object íƒ€ì…ì„ value ê°’ìœ¼ë¡œ ë„£ì—ˆë‹¤.
    private final Map<String, Object> handelerMappingMap = new HashMap<>();
    private final List<MyHandlerAdapter> handlerAdapters = new ArrayList<>();

    public FrontControllerServletV5() {
        initHandlerMappingMap();
        initHandlerAdapters();
    }

    private void initHandlerMappingMap() {
        handelerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
        handelerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
        handelerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());
    }

    private void initHandlerAdapters() {
        handlerAdapters.add(new ControllerV3HandlerAdapter());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String requestURI = request.getRequestURI();
        //URI(key)ê°’ì˜ value(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ handler ì— ì €ì¥.
        Object handler = handelerMappingMap.get(requestURI);

        if(handler == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND); //ì›¹ ìƒíƒœì½”ë“œë¥¼ 404ë¡œ ë°”ê¾¸ê³  ë¦¬í„´.
            return;
        }

        //í•´ë‹¹ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ì— ë§ëŠ” ì–´ëŒ‘í„° ê°€ì ¸ì˜¤ê¸°
        MyHandlerAdapter adapter = getHandlerAdapter(handler);

        //V3 í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ì˜ ê²½ìš°, ModelView í˜•íƒœë¥¼ ì‚¬ìš©í•œë‹¤. í•´ë‹¹ ì–´ëŒ‘í„°ì—ì„œ ê° ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•´ì¤Œ.
        ModelView mv = adapter.handle(request, response, handler);
        //ì´í•˜ ê³¼ì •ì€ V3 íŒ¨í‚¤ì§€ ë‚´ìš©ê³¼ ë™ì¼.
        String viewName = mv.getViewName();
        MyView view = viewResolver(viewName);

        view.render(mv.getModel(), request,response);
    }

    private MyHandlerAdapter getHandlerAdapter(Object handler) {
        for (MyHandlerAdapter adapter : handlerAdapters) {
            if(adapter.supports(handler)) {
                return adapter;
            }
        }
        throw new IllegalArgumentException("handler adapterë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. handler = " + handler);
    }

    private static MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }
}

```

### âš¡ï¸ &nbsp; 5-3. ControllerV3HandlerAdapter

- 5-1ì˜ MyHandlerAdapter ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” êµ¬í˜„ì²´. V3 ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë°˜í™˜í•˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤.

```java

public class ControllerV3HandlerAdapter implements MyHandlerAdapter {
    @Override
    public boolean supports(Object handler) {
        //ControllerV3 ì˜ ì¸ìŠ¤í„´ìŠ¤ì•¼? ë¬¼ì–´ë³´ê³  ë§ìœ¼ë©´ true, ì•„ë‹ˆë©´ falseë¥¼ ë°˜í™˜í•˜ëŠ” êµ¬ì¡°
        return (handler instanceof ControllerV3);
    }

    //V3 ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ModelView ê°ì²´ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ë§ëŠ” íƒ€ì…ì˜ í•¸ë“¤ì„ ë§Œë“ ë‹¤.
    @Override
    public ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException {
        ControllerV3 controllerV3 = (ControllerV3) handler;
        Map<String, String> paramMap = createParamMap(request);
        ModelView mv = controllerV3.process(paramMap);
        return mv;
    }

    private static Map<String, String> createParamMap(HttpServletRequest request) {
        Map<String, String> paramMap = new HashMap<>();
        request.getParameterNames().asIterator().forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
        return paramMap;
    }

}
```

ğŸ¤”ğŸ’­ ê·¸ë˜ë´¤ì V3 í•¸ë“¤ëŸ¬ë§Œ ì¶”ê°€í–ˆì–ì•„. ê°í¥ì´ ì—†ëŠ”ê±¸... â¡ï¸ V4 ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì¶”ê°€í•´ë³´ì.
